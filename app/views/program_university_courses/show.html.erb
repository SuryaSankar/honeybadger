<%- model_class = ProgramUniversityCourse -%>
<% content_for :title do %>
<%= "Karpeer - "+@program_university_course.full_course_name %>
<% end %>
<% content_for :mathjax_scripts do %>
<%= render partial: 'partials/mathjax_include' %>
<% end %>
<% content_for :prettify_scripts do %>
<%= render partial: 'partials/prettify_include' %>
<% end %>

<% content_for :pagewise_heading do %>
	<%= @program_university_course.university_course.course_code+" - "+@program_university_course.university_course.course.name %>
<% end %>
<% content_for :navbar_breadcrumbs do %>
	<ul class="nav">
	  <li><%= link_to root_path do %>Home &nbsp;&nbsp;<i class="icon-double-angle-right"></i><% end %></li>
<li><%= link_to @program_university_course.full_course_name, '#' %></li>
</ul>
<% end %>

<% content_for :side_navigation do %>

<%# render partial: "partials/universitycourses_accordion", locals: { pucs_semwise: @program_university_course.program.program_university_courses.where.not(semester: nil).includes(university_course: :course).order("semester").group_by { |puc| puc.semester }, elective_pucs:  @program_university_course.program.program_university_courses.where(elective: true).includes(university_course: :course) } %>
<% end %>
<%# render partial: "partials/units", object: @program_university_course.university_course.units %>
<div class="right-bordered-box">
            <div class="heading"><h4>Question Papers</h4></div>
	    <div class="bordered-box-content">
		<% qpapers = @program_university_course.university_course.qpapers %>
		<% if qpapers.length > 0 then %>
		<ol>
		<% qpapers.each do |qp| %>
		<li>
		<%= link_to qp.title+" "+qp.month+" "+qp.year.to_s, qpaper_path(qp.id)+"?puc="+@program_university_course.id.to_s %>
		</li>
		<% end %>
		</ol>
		<% else %>
		There are no question papers yet for this course.
		<% end %>
		<div id="underlined-h5"><h5>Upload a question paper</h5></div>
		<%= bootstrap_flash %>
		<%= simple_form_for :qpaper_file, :url => qpaper_files_path, :html => { :multipart => true } do |form| %>
		  <%= form.file_field :uploaded_file %>
		  <%= form.input :university_course_id, :as => :hidden, :input_html => { :value => @program_university_course.university_course_id } %>
		  <%= submit_tag "Upload", class: "btn btn-success" %>
		<% end %>
	    </div><!-- bordered-box-content -->
</div><!-- bordered-box -->





<div class="right-bordered-box">
            <div class="heading"><h4>Questions</h4></div>
	    <div class="bordered-box-content">
<p><h5> <%= link_to "Add a question" , new_question_path+"?course="+@program_university_course.university_course.course_id.to_s %> </h5></p>
	<% if Question.where(course_id: @program_university_course.university_course.course_id).where(standalone: false).count > 0 then %>
		<h5>Questions obtained from question papers</h5>
		<% questions = Question.joins(:examquestions).where(course_id: @program_university_course.university_course.course_id).where(standalone: false).order('examquestions.mark ASC').group_by { |q| q.examquestions.first.mark } %>
		<% questions.keys.each do |mark| %>
		<h6><%= mark %> Marks</h6>
		<ol>
		<% questions[mark].each do |q| %>
		 <li><%= link_to (q.qtitle || q.qtext), question_path(q.id) %></li>
		<% end %>
		</ol>
		<% end %>
	<% end %>
<%# render partial: "partials/questions", locals: { questions: @program_university_course.university_course.course.questions } %>
	    </div>
</div>


<% if admin_signed_in? then %>
<div class="form-actions">
  <%= link_to t('.back', :default => t("helpers.links.back")),
              program_university_courses_path, :class => 'btn'  %>
  <%= link_to t('.edit', :default => t("helpers.links.edit")),
              edit_program_university_course_path(@program_university_course), :class => 'btn' %>
  <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
              program_university_course_path(@program_university_course),
              :method => 'delete',
              :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
              :class => 'btn btn-danger' %>
</div>

<% end %>
